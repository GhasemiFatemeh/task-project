<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Tasks</title>
    <link href="../icon/2199111_add_create_new_plus_icon.png" rel="icon">
    <link href="../imports/fontawesome-free-5.15.3-web/css/all.min.css" rel="stylesheet">
    <link href="../imports/bootstrap.min.css" rel="stylesheet">
    <link href="../css/insert.css" rel="stylesheet">
    <script src="../js/taskManagement.js"></script>
</head>
<body>
<header class="">

    <h1 class="text-white text-center m-4">Add Task</h1>
    <div class="text-center mb-4"><a href="../../index.html" onclick="location.reload()" class="text-white text-center border rounded-circle p-3 mb-5"><i class="fas fa-home"></i></a></div>
</header>
<main class="mb-4">
    <div class="col-7 m-auto border rounded p-4">
        <form id="form" method="Get">
            <div class="d-flex">
                <div class="form-group col-6">
                    <label class="text-white" for="taskId">Task ID</label>
                    <input autofocus class="form-control necessary-input" id="taskId" name="taskId" required
                           type="number">
                </div>
                <div class="form-group col-6">
                    <label class="text-white" for="taskTitle">Task Title</label>
                    <input class="form-control necessary-input" id="taskTitle" name="title" required type="text">
                </div>
            </div>
            <div class="form-group col-12">
                <label class="text-white" for="taskDescription">Description</label>
                <textarea class="form-control" id="taskDescription" name="description" rows="9" type="text"></textarea>
            </div>
            <div class="d-flex justify-content-center">
                <button type="button" onclick="sendInformation()" class="btn btn-default btn-link btn-success text-decoration-none text-white mr-2">Submit</button>
                <button type="button" onclick="redirectTasksPage()" class="btn btn-link btn-warning text-decoration-none text-white">
                    See All Tasks
                </button>
            </div>
        </form>
    </div>
    <div id="successSnackbar"><p class="text-center bg-success rounded text-white p-2">Task is successfully saved!</p></div>
    <div id="failedSnackbar"><p class="text-center bg-danger rounded text-white p-2">Task isn't saved successfully!</p></div>
</main>
<script>

    function sendInformation() {
        let taskId = document.getElementById('taskId').value;
        let title = document.getElementById('taskTitle').value;
        let description = getValidTextForSendRequest(document.getElementById('taskDescription').value);
        let req = 'http://localhost:8081/tasks/manageTasks/register?taskId=' + taskId + '&title=' + title + '&description=' + description;
        let http;
        if (navigator.appName === "Microsoft Internet Explorer") {
            http = new ActiveXObject("Microsoft.XMLHTTP");
        } else {
            http = new XMLHttpRequest();
        }
        http.open("GET", req, true);
        http.send();
        http.onreadystatechange = function () {
            if (http.readyState === 4 ) {
                if (http.status === 200) {
                    http.responseText;
                    showSuccessSnackbar();
                }
                else {
                    showFailedSnackbar();
                }
            }
        }
    }

    function redirectTasksPage(){
        location.replace("http://localhost:8081/TaskWeb/view/taskManagement.html");
    }
    function showSuccessSnackbar() {
        let x = document.getElementById("successSnackbar");
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }
    function showFailedSnackbar(){
        let x = document.getElementById("failedSnackbar");
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

</script>
</body>
</html>